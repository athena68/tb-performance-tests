#
# Copyright © 2016-2025 The Thingsboard Authors
#
# Licensed under the Apache License, Version 2.0 (the "License");
# you may not use this file except in compliance with the License.
# You may obtain a copy of the License at
#
#     http://www.apache.org/licenses/LICENSE-2.0
#
# Unless required by applicable law or agreed to in writing, software
# distributed under the License is distributed on an "AS IS" BASIS,
# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
# See the License for the specific language governing permissions and
# limitations under the License.
#

# Smart Tracker Telemetry Data Configuration
# GPS tracking device telemetry data points and ranges

# Telemetry data points definition
data_points:
  # GPS location telemetry
  latitude:
    unit: "degrees"
    min: -90
    max: 90
    default: 21.0285
    precision: 6               # 6 decimal places
    persistent: false          # Always changing
    variation: 0.0001          # Small movement variations

  longitude:
    unit: "degrees"
    min: -180
    max: 180
    default: 105.8542
    precision: 6
    persistent: false
    variation: 0.0001

  altitude:
    unit: "meters"
    min: -500
    max: 10000
    default: 50
    precision: 1
    persistent: false
    variation: 5.0

  # GPS quality and status
  gps_accuracy:
    unit: "meters"
    min: 1
    max: 50
    default: 3.0
    persistent: false
    ideal_range: "1-10"

  satellites_count:
    unit: "count"
    min: 4
    max: 20
    default: 12
    persistent: false
    thresholds:
      poor: "< 6"
      good: "6-12"
      excellent: "> 12"

  gps_fix_type:
    unit: ""
    values: [0, 1, 2, 3]
    mapping:
      0: "No Fix"
      1: "GPS Fix"
      2: "DGPS Fix"
      3: "RTK Fix"
    default: 1
    probabilities:
      0: 0.02      # 2% no fix
      1: 0.85      # 85% GPS fix
      2: 0.12      # 12% DGPS
      3: 0.01      # 1% RTK

  # Motion telemetry
  speed:
    unit: "km/h"
    min: 0
    max: 200
    default: 0
    persistent: false
    motion_correlation: true

  heading:
    unit: "degrees"
    min: 0
    max: 360
    default: 0
    persistent: false
    speed_threshold: 5        # Only valid when speed > 5 km/h

  acceleration:
    unit: "m/s²"
    min: -10
    max: 10
    default: 0
    persistent: false
    motion_events: true

  # Device status telemetry
  battery_level:
    unit: "%"
    min: 0
    max: 100
    default: 85
    persistent: true         # Slowly decreases
    drain_rate: 0.1           # % per hour when active
    charge_rate: 5.0          # % per hour when charging

  battery_voltage:
    unit: "V"
    min: 3.0
    max: 4.2
    default: 3.9
    formula: "3.0 + (battery_level / 100 * 1.2)"
    persistent: true

  signal_strength:
    unit: "dBm"
    min: -120
    max: -30
    default: -75
    quality_levels:
      excellent: ">-70"
      good: "-70 to -85"
      fair: "-85 to -100"
      poor: "<-100"

  device_temperature:
    unit: "°C"
    min: -20
    max: 60
    default: 25
    ambient_correlation: true
    variation: 5.0

  # Network telemetry
  network_type:
    unit: ""
    values: ["4G", "3G", "2G", "No Signal"]
    default: "4G"
    signal_based: true

  data_usage_mb:
    unit: "MB"
    min: 0
    max: 10240
    default: 0
    cumulative: true
    daily_average: 5.0

  last_update_time:
    unit: "timestamp"
    format: "ISO8601"
    auto_generate: true
    timezone: "UTC"

# Special device configurations
special_devices:
  # Devices that should show stationary status
  stationary_devices:
    devices: ["ST00000001", "ST00000005", "ST00000010"]
    config:
      speed: 0
      motion_status: "Stationary"
      gps_fix_type: 1
      update_interval: 3600    # 1 hour updates when stationary

  # Devices that are moving (vehicles)
  moving_devices:
    devices: ["ST00000002", "ST00000006", "ST00000011"]
    config:
      speed: [45, 60, 80]      # Variable speed
      motion_status: "Moving"
      update_interval: 30      # 30 second updates

  # Devices with poor signal
  poor_signal_devices:
    devices: ["ST00000003", "ST00000007"]
    config:
      signal_strength: -110
      network_type: "3G"
      gps_accuracy: 15

# Data generation rules
generation_rules:
  update_intervals:
    moving: 30                 # seconds
    stationary: 3600           # 1 hour
    emergency: 10              # 10 seconds
    low_battery: 60            # 1 minute

  motion_simulation:
    speed_change_rate: 5.0     # km/h per update
    heading_change_rate: 15    # degrees per update
    urban_speed_max: 60
    highway_speed_max: 120

  battery_simulation:
    active_drain: 0.1          # % per hour
    sleep_drain: 0.01          # % per hour
    gps_power_drain: 0.05      # Additional % per hour
    charging_efficiency: 0.9

  location_simulation:
    urban_accuracy: 10         # meters
    suburban_accuracy: 5       # meters
    open_sky_accuracy: 2       # meters

# Geographic constraints
geographic_constraints:
  # Hanoi area coordinates (example)
  hanoi_area:
    latitude_min: 20.8
    latitude_max: 21.3
    longitude_min: 105.6
    longitude_max: 106.0

  # Ho Chi Minh City area
  hcmc_area:
    latitude_min: 10.6
    latitude_max: 11.0
    longitude_min: 106.5
    longitude_max: 107.0

# Alert conditions
alert_conditions:
  speed_alert:
    threshold_kmh: 120
    hysteresis: 5              # Reset at 115 km/h

  geofence_alert:
    breach_distance_meters: 10
    entry_exit_both: true

  low_battery_alert:
    threshold_percent: 20
    critical_percent: 10

  no_signal_alert:
    timeout_minutes: 15

  tamper_alert:
    accelerometer_threshold: 2.0  # g-force
  # Historical data simulation
historical:
  start_date: "2024-01-01"
  typical_routes:
    urban_delivery:
      stops_per_hour: 3
      avg_speed_kmh: 35
      operating_hours: "08:00-18:00"

    highway_transport:
      stops_per_hour: 0.5
      avg_speed_kmh: 90
      operating_hours: "00:00-24:00"

    service_vehicle:
      stops_per_hour: 8
      avg_speed_kmh: 25
      operating_hours: "07:00-19:00"